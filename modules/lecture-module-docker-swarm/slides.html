                <section data-background="#445d6e" class="gray_bg">
					<h2><img src="images/icon_lecture.png" class="slide_icon" alt="icon"> Mini Lecture: Docker Classic Swarm</h2>
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>What is Classic Swarm</h2>
                    <ul>
						<li>"Classic Swarm" is our unofficial term for referring to the previous open source Swarm project</li>
						<ul>
							<li><a href="https://github.com/docker/swarm">https://github.com/docker/swarm</a></li>
							<li><a href="https://docs.docker.com/swarm/overview/">https://docs.docker.com/swarm/overview/</a></li>
						</ul>
						<li>Was Docker's native clustering solution before the introduction of Swarm mode in Engine 1.12</li>
                        <li>Tool that clusters Docker hosts and schedules containers on them</li>
                        <li>Allows us to distribute container workloads</li>
                        <li>Serves the standard Docker API</li>
                        <li>Ships with simple scheduling and discovery backend</li>
                    </ul>
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>How Swarm works</h2>
					<p><img src="images/classic_swarm_1.PNG" width="80%"></p>
					
					<aside class="notes">
					Ok, let's sat we start with our 1 node. We have our Docker Engine installed and our CLI on the same node pointing to the Engine
					</aside>
				</section>
				
				<section data-background="#445d6e" class="gray_bg">
					<h2>How Swarm works (cont'd)</h2>
					<p><img src="images/classic_swarm_2.PNG" width="80%"></p>
					
					<aside class="notes">
					We want to get a cluster of Engines up and running so let's provision two additional nodes, with Docker Engines installed.
					</aside>
				</section>
                
				<section data-background="#445d6e" class="gray_bg">
					<h2>How Swarm works (cont'd)</h2>
					<p><img src="images/classic_swarm_3.PNG" width="80%"></p>
					
					<aside class="notes">
					We then go back to our original host and install a Swarm Manager. This manager is usually installed and run in a container. Then we join our two nodes 
					via the manager, so our manager knows which nodes are part of the cluster. How it keeps track of the nodes depends on the scheduling backend you choose.
					</aside>
				</section>
				
				<section data-background="#445d6e" class="gray_bg">
					<h2>How Swarm works (cont'd)</h2>
					<p><img src="images/classic_swarm_4.PNG" width="80%"></p>
					
					<aside class="notes">
					Finally, on our host, we no longer have our CLI pointed to the Docker Engine on the host, we point it to the Swarm manager instead. That way when we run our docker commands, it goes through the manager. 
					For example, if we did a docker run command to schedule a container, the manager would be able to decide which node to run the container on. The Swarm manager supports the standard docker API.
					</aside>
				</section>
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>Discovery backends</h2>                   
					<div class="cell"><p>Hosted discovery</p></div>                    
                    <div style="width: 100%; overflow: hidden;">
                    <div class="third_container_one"><div class="cell" style="overflow: hidden; height: 130px; padding-top: 10px !important;"><img src="images/etcd.png" style="border: none; background: none; box-shadow: none; padding-top: 5px;"></div></div>
                    <div class="third_container_two"><div class="cell" style="overflow: hidden; height: 130px; padding-top: 10px !important;"><img src="images/consul.png" style="border: none; background: none; box-shadow: none;"></div></div>
                    <div class="third_container_three"><div class="cell" style="overflow: hidden; height: 130px; padding-top: 10px !important;"><img src="images/zookeeper.png" style="border: none; background: none; box-shadow: none;"></div></div>
                    </div>
					<div class="cell"><p>Static files</p></div>                   
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>Classic Swarm and UCP 2.0</h2>
                    <ul>
                        <li>UCP 2.0 runs on the new Swarm mode in Engine 1.12</li>
						<li>However classic Swarm implementation is still present to provide for backwards compatability</li>
						<li><code>ucp-swarm-manager</code> container is present on all manager nodes in UCP 2.0</li>
						<li>Cannot deploy standard Docker containers through the web UI but you can use the Docker CLI via the client bundle</li>
						<li>Can deploy Docker Compose applications via web UI and client bundle</li>
                    </ul>
					
					<aside class="notes">
					<b>Instructor note: </b> Consider showing the ucp-swarm-manager container either in the SSH terminal of your ucp-controller node or through the web UI
					</aside>
					
				</section>
                
     
                
                
                <section data-background="#445d6e" class="gray_bg">
                
                	<section>
                        <h2>Scheduling containers in the cluster</h2>
                        <ul>
                            <li>How does Swarm decide which node your container runs on?</li>
                            <li>The Docker Swarm scheduler ranks nodes based on a number of different strategies / algorithms</li>
                            <li>When you run a container, Swarm will place it in the node with the highest rank</li>
                            <li>How the rank is calculated depends on your selected strategy</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h3>Two strategies</h3>
                        <div class="half_container_one"><div class="cell"><p>Spread</p></div></div>
                        <div class="half_container_two"><div class="cell"><p>Binpack</p></div></div>
                    </section>
                    
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>Spread Strategy</h2>
                    <ul>
                        <li>The spread strategy ranks nodes based on the number of containers</li>
                        <li>Swarm will schedule the container on the node that has the least number of containers running</li>
                        <li>If multiple nodes have the same least number of containers running, Swarm will pick one of those nodes at random</li>
                    </ul>
					
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>Binpack strategy</h2>
                    <ul>
                        <li>When using the binpack strategy, Swarm will try to fit as many containers into a node as possible, before using another node</li>
                        <li>Optimizes for the container that is the most packed</li>
                        <li>Swarm will continue to schedule containers on the same node until there are insufficient resources (CPU, RAM) on that node</li>
                    </ul>
					<aside class="notes">Note: when using binpack you have to specify the memory and/or CPU allocation when running containers. Otherwise Swarm will pack every container into the one host regardless of its resources.
                    </aside>
				</section>
                
                
                
                <section data-background="#445d6e" class="gray_bg">
					<h2>UCP scheduling</h2>
                    <ul>
                        <li>Defaults to spread strategy</li>
                        <li>Option can be configured during the installation procedure</li>
                        <li>Cannot be changed on the fly</li>
                    </ul>
				</section>